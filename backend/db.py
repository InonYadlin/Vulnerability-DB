from pymongo import MongoClient
from pymongo.errors import ServerSelectionTimeoutError
from config import *

# MongoDB Connection Management Functions
def connect_to_mongo(uri):
    """Connects to the MongoDB client."""
    try:
        client = MongoClient(uri)
        return client
    except ServerSelectionTimeoutError:
        print("Failed to connect to MongoDB")
        return None

# Function meant to fetch a collection
def fetch_collection(client, db_name, collection_name):
    """Fetches a specific collection from the MongoDB database."""
    db = client[db_name]
    return db[collection_name]

# Function which closes the connection to the db 
def close_mongo_connection(client):
    """Closes the MongoDB client connection."""
    client.close()